import{j as t,at as v,r as n,cH as C,bo as N,a9 as y,v as I,av as A,u as F,T as h,c1 as L}from"./main-BEfQELxr.js";import{o as p,P as S,q as k,u as w}from"./share-media-button-C9oFSM6L.js";import{A as D,a as B}from"./avatar-group-BJHmqeAp.js";import{o as E,a as g}from"./offline-media-items-DO4Xib0S.js";import{u as O}from"./add-to-queue-menu-button-xRsy1m89.js";import{A as _}from"./album-image-sKMZR621.js";import{A as G}from"./album-link-6XmWl295.js";import{g as M}from"./artist-link-fBSSBvhd.js";import{G as q}from"./genre-link-CzCNmJwP.js";import{B as H}from"./bullet-separated-items-BFxNMU00.js";import{M as Q,a as j}from"./media-page-header-layout-ouASZtwH.js";import{P as $}from"./player-page-header-gradient-QFN0d4GT.js";import{P as W}from"./player-page-suspsense-BeDCBfjQ.js";import{u as z,T as R,C as U}from"./truncated-description-CG6NKLqH.js";import{u as V}from"./use-track-permissions-BH8RwNVs.js";import{C as J,b as K,T as X}from"./comment-bar-new-comment-form-CF3mhZxo.js";import{T as Y}from"./track-image-DjYnH9n0.js";import{T as Z}from"./track-table-BzIUEBZK.js";import{t as ee}from"./track-context-dialog-B8siridC.js";import{W as te}from"./waveform-8pPmo81H.js";import{A as b}from"./ad-host-DTAFXere.js";import{P as re}from"./page-meta-tags-BmlELluj.js";import{u as T}from"./use-required-params-biXhH1lK.js";import{u as se}from"./use-sortable-table-data-CTahzIRp.js";import{u as oe}from"./useSuspenseQuery-CLDVgKJu.js";import{C as ae}from"./chip-list-CnaxlPJ9.js";import{F as ie}from"./formatted-date-B-08Y9yP.js";import{F as me}from"./formatted-duration-Dqg2KYhd.js";import{F as ne}from"./formatted-number-ChBvIyPq.js";import"./play-arrow-filled-Bd3mp8QD.js";import"./use-player-store-B0Tt1GmI.js";import"./is-ctrl-or-shift-pressed-CMgU9cG9.js";import"./middleware-BLXTWOs6.js";import"./traditional-D9TTECMQ.js";import"./Pause-BRJy77mF.js";import"./create-playlist-dialog-BfNYpT-L.js";import"./image-selector-D_1V7xO8.js";import"./file-upload-provider-eR3r-15c.js";import"./uploaded-file-DYvUNPPs.js";import"./extension-from-filename-O0XMuZye.js";import"./pretty-bytes-bO14ePu9.js";import"./use-active-upload-nc09ZUBt.js";import"./open-upload-window-B2GQndIr.js";import"./AddAPhoto-CZHH8SXN.js";import"./file-input-config-DrcTpI3-.js";import"./switch-kVp777pB.js";import"./Image-DEFAf6mh.js";import"./dialog-footer-DZFPEWVp.js";import"./use-auth-click-capture-BYdy-0wK.js";import"./Add-Cqjx6ezR.js";import"./KeyboardArrowRight-BVstfQVU.js";import"./FavoriteBorder-CFF5lN5d.js";import"./use-previous-C8UpiCgw.js";import"./small-artist-image-CgkHpn0Q.js";import"./Mic-cPqrQSx8.js";import"./playlist-image-CVgZeVzU.js";import"./PlaylistPlay-jDnYmdDX.js";import"./playlist-link-BuIn8fqZ.js";import"./share-media-buttons-LsRpAgAp.js";import"./Share-CwHQAfaU.js";import"./track-link-C79i7Oi0.js";import"./tabs-QG1LNIzu.js";import"./tab-panels-DmVy49av.js";import"./use-clipboard-C55rQ_RF.js";import"./check-circle-filled-DrCIo0X8.js";import"./Download-Dfp9nObW.js";import"./Album-CXNrxcWI.js";import"./external-link-CT1zJoZ3.js";import"./use-delete-comments-DstBHm9_.js";import"./Reply-B32MlVig.js";import"./MoreVert-Dq4kJhtz.js";import"./confirmation-dialog-CYwhNB58.js";import"./infinite-scroll-sentinel-CMv-6kYI.js";import"./use-flat-infinite-query-items-YeEYVBoR.js";import"./useSuspenseInfiniteQuery-BxRXpJI4.js";import"./infiniteQueryObserver-GtpVk2tr.js";import"./Comment-TqhRbk6J.js";import"./skeleton-IvCa_cqw.js";import"./use-linkified-string-C1m5nlj_.js";import"./linkify-Cbuu_PPG.js";import"./album-context-dialog-DOovC4OY.js";import"./use-delete-album-DEYa43GE.js";import"./use-album-permissions-B3fFfLlx.js";import"./artist-links-CJ-I-YoG.js";import"./toggle-in-library-menu-button-DeSIBdG_.js";import"./toggle-repost-menu-button-DQ7TGSVf.js";import"./Repeat-DvTTdzvg.js";import"./MoreHoriz-B7xw7d55.js";import"./MusicNote-D6buyZMC.js";import"./table-Bdp6S_DF.js";import"./checkbox-C191zCCH.js";import"./CheckBoxOutlineBlank-B_WkUAPG.js";import"./ArrowDownward-i0hV0JR6.js";import"./useInteractOutside-Iqh6soAi.js";import"./useEffectEvent-TynbBUG3.js";import"./use-pointer-events-CdAPueCj.js";import"./useGlobalListeners-BF1tAQIT.js";import"./entitiy-offline-indicator-icon-CUcYL0oT.js";import"./like-icon-button-BVGCt62o.js";import"./Schedule-DYoblKcK.js";import"./TrendingUp-CQH53zcx.js";import"./use-should-show-radio-button-D61M8rRZ.js";import"./download-file-from-url-BVaKcxRP.js";import"./use-slider-CuTkwfyF.js";import"./generate-waveform-data-BFwf5N3g.js";import"./getScrollParent--OCc5gFh.js";import"./default-meta-tags-Bj5ecgXc.js";import"./sort-array-of-objects-Oyr6J2gK.js";import"./use-date-formatter-BKDPf1lG.js";import"./DateFormatter-Dix9bfnP.js";import"./use-current-date-time-Bg8tRM7A.js";function br(){return t.jsx(W,{offlineFallback:t.jsx(fe,{}),children:t.jsx(le,{})})}function le(){const{trackId:e}=T(["trackId"]),s=oe(v.tracks.get(e,"trackPage"));return t.jsx(P,{data:s.data})}function pe({album:e,track:s}){var m;const i=(m=e==null?void 0:e.tracks)!=null&&m.length?e.tracks:[s],{data:r,sortDescriptor:o,onSortChange:a}=se(i);return t.jsxs("div",{className:"mt-44",children:[t.jsxs("div",{className:"mb-14 flex items-center gap-16 overflow-hidden rounded bg-hover",children:[t.jsx(_,{album:e,className:"flex-shrink-0 rounded",size:"w-70 h-70"}),t.jsxs("div",{className:"flex-auto",children:[t.jsx("div",{className:"text-sm",children:t.jsx(h,{message:"From the album"})}),t.jsx("div",{className:"text-sm font-semibold",children:t.jsx(G,{album:e})})]})]}),t.jsx(Z,{queueGroupId:k(e),tracks:r,sortDescriptor:o,onSortChange:a,hideTrackImage:!0,hideAlbum:!0,hidePopularity:!1})]})}function ce({track:e}){var c,u,f,d,x;const s=A(),i=O(),{player:r}=F(),o=((c=e.album)==null?void 0:c.release_date)||e.created_at,a=(u=e.genres)==null?void 0:u[0],m=!s&&(r==null?void 0:r.seekbar_type)==="waveform"&&ee(e);return t.jsx(n.Fragment,{children:t.jsx(Q,{image:t.jsx(Y,{track:e,className:"rounded-panel"}),title:e.name,subtitle:t.jsx(D,{children:(f=e.artists)==null?void 0:f.map(l=>t.jsx(L,{circle:!0,src:l.image_small,label:l.name,link:M(l)},l.id))}),description:t.jsxs(H,{className:"text-sm",children:[e.duration?t.jsx(me,{ms:e.duration,verbose:!0}):null,o&&t.jsx(ie,{date:o}),a&&t.jsx(q,{genre:a}),e.plays&&!(r!=null&&r.enable_repost)?t.jsx(h,{message:":count plays",values:{count:t.jsx(ne,{value:e.plays})}}):null]}),actionsBar:t.jsxs(X,{item:e,managesItem:!1,buttonGap:void 0,buttonSize:"sm",buttonClassName:j(),children:[t.jsx(S,{buttonType:"text",track:e,tracks:(x=(d=e.album)==null?void 0:d.tracks)!=null&&x.length?e.album.tracks:void 0,className:j({isFirst:!0}),queueId:k(e.album||e)}),i?t.jsx(ue,{track:e}):null]}),footer:m?t.jsx(te,{track:e,className:"max-md:hidden"}):void 0})})}function P({data:e}){var o;const{canView:s,canCreate:i}=z(),{canEdit:r}=V([e.track]);return t.jsxs(t.Fragment,{children:[e.track.image&&t.jsx($,{image:e.track.image}),t.jsxs("div",{className:"relative",children:[t.jsxs(J,{children:[t.jsx(re,{data:e}),t.jsx(b,{slot:"general_top",className:"mb-44"}),t.jsx(ce,{track:e.track}),i?t.jsx(K,{className:"mb-16",commentable:e.track}):null]}),(o=e.track.tags)!=null&&o.length?t.jsx(N,{children:t.jsx(ae,{className:"mb-16",color:"bg-fg-base/8",selectable:!0,children:e.track.tags.map(a=>t.jsxs(y,{elementType:I,to:`/tag/${a.name}`,children:["#",a.display_name||a.name]},a.id))})}):null,t.jsx(R,{description:e.track.description,className:"mt-24 text-sm"}),s?t.jsx(U,{className:"mt-34",commentable:e.track,canDeleteAllComments:r}):null,e.track.album&&t.jsx(pe,{album:e.track.album,track:e.track}),t.jsx(b,{slot:"general_bottom",className:"mt-44"})]})]})}function ue({track:e}){const[s,i]=n.useState(0),r=w(o=>o.offlinedTrackIds.has(e.id));return n.useEffect(()=>{if(r){const o=()=>{const a=g.getDownloadProgress().entries().find(([m])=>m===e.id);i((a==null?void 0:a[1])??0)};return o(),g.listen("onActiveDownloadsChanged",o)}},[r]),t.jsx(B,{isOfflined:r,className:"mr-8",progress:s,onClick:()=>{r?p().deleteOfflinedTracks([e]):p().offlineTracks([e])}})}function fe(){const[e,s]=n.useState(null),[i,r]=n.useState(!0),{trackId:o}=T(["trackId"]);return n.useEffect(()=>{de(+o).then(s).finally(()=>r(!1))},[o]),e?t.jsx(P,{data:e}):i?null:t.jsx(C,{})}async function de(e){if(!p().offlinedTrackIds.has(e))return null;const s=await E.get(e),i=s==null?void 0:s.data;return i?{loader:"trackPage",track:i}:null}export{br as Component};
