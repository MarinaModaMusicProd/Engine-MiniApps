import{z as g,G as j,H as f,I as v,J as S,b as h,a as _,M as b,j as e,T as s,P as l,r as n,Q as a,t as M,V as c}from"./main-BEfQELxr.js";import{a as d}from"./admin-config-BaCrw7Kt.js";import{S as y}from"./settings-error-group-BAeciTuR.js";import{A as F}from"./settings-layout-CUpx_aK_.js";import{D as w}from"./settings-links-BagG4yO6.js";import{S as u}from"./settings-panel-9vXv66Le.js";import{u as q}from"./use-admin-settings-B1D6D_PM.js";import{S as A}from"./section-helper-BaiMamTr.js";import{F as p,S as D}from"./select-DvPFHFsY.js";import"./Album-CXNrxcWI.js";import"./Comment-TqhRbk6J.js";import"./FileUpload-DPKPUe4e.js";import"./Mic-cPqrQSx8.js";import"./PlaylistPlay-jDnYmdDX.js";import"./QueueMusic-C8vaKlwp.js";import"./Sell-DvbBmLb2.js";import"./middleware-BLXTWOs6.js";import"./use-admin-settings-page-nav-config-CxHuJeZb.js";import"./datatable-page-with-header-layout-DgFKm91D.js";import"./dashboard-layout-context-Ors6hOMs.js";import"./use-toggle-dashboard-left-sidebar-BNAUqBUz.js";import"./file-upload-provider-eR3r-15c.js";import"./uploaded-file-DYvUNPPs.js";import"./extension-from-filename-O0XMuZye.js";import"./pretty-bytes-bO14ePu9.js";import"./traditional-D9TTECMQ.js";import"./confirmation-dialog-CYwhNB58.js";import"./dialog-footer-DZFPEWVp.js";import"./external-link-CT1zJoZ3.js";import"./useSuspenseQuery-CLDVgKJu.js";import"./combobox-end-adornment-B98K5MYg.js";function N(){const{trans:r}=g();return j({mutationFn:t=>E(t),onSuccess:()=>{v(r(S("Imported search models")))},onError:t=>f(t)})}function E(r){return h.post("admin/search/import",r).then(t=>t.data)}function I(){return _({queryKey:["search-models"],queryFn:()=>T()})}function T(){return h.get("admin/search/models").then(r=>r.data)}function ge(){const{data:r}=q(),t=b({defaultValues:{server:{scout_driver:r.server.scout_driver??"mysql",scout_mysql_mode:r.server.scout_mysql_mode??"basic",algolia_app_id:r.server.algolia_app_id??"",algolia_secret:r.server.algolia_secret??""}}});return e.jsxs(F,{form:t,title:e.jsx(s,{message:"Search"}),children:[e.jsx(k,{}),e.jsx(R,{})]})}function k(){const{watch:r}=l(),t=r("server.scout_driver");return e.jsx(u,{className:"mb-24",title:e.jsx(s,{message:"Search Method"}),description:e.jsx("div",{children:e.jsx(s,{message:"Configure which search method should be used for search functionality across your site."})}),link:d.settings.search?e.jsx(w,{link:d.settings.search,children:e.jsx(s,{message:"What's the difference between the search methods?"})}):null,children:e.jsx(y,{name:"search_group",separatorBottom:!1,separatorTop:!1,children:i=>e.jsxs(n.Fragment,{children:[e.jsxs(p,{size:"sm",invalid:i,name:"server.scout_driver",selectionMode:"single",label:e.jsx(s,{message:"Search method"}),children:[e.jsx(a,{value:"mysql",children:"Database (Default)"}),e.jsx(a,{value:"meilisearch",children:"Meilisearch (Recommended)"}),e.jsx(a,{value:"tntsearch",children:"TNTSearch"}),e.jsx(a,{value:"algolia",children:"Algolia"})]}),t==="mysql"&&e.jsx(z,{}),t==="meilisearch"&&e.jsx(C,{}),t==="algolia"&&e.jsx(P,{})]})})})}function z(){const{clearErrors:r}=l();return e.jsxs(p,{size:"sm",className:"mt-24",name:"server.scout_mysql_mode",selectionMode:"single",label:e.jsx(s,{message:"Database search mode"}),onSelectionChange:()=>{r()},children:[e.jsx(a,{value:"basic",children:e.jsx(s,{message:"Basic"})}),e.jsx(a,{value:"extended",children:e.jsx(s,{message:"Extended"})}),e.jsx(a,{value:"fulltext",children:e.jsx(s,{message:"Fulltext"})})]})}function C(){return e.jsx(A,{className:"mt-24",color:"warning",description:e.jsx(s,{message:"<a>Meilisearch</a> needs to be installed and running for this method to work.",values:{a:r=>e.jsx("a",{href:"https://www.meilisearch.com",target:"_blank",rel:"noreferrer",children:r})}})})}function P(){return e.jsxs(n.Fragment,{children:[e.jsx(c,{size:"sm",className:"mt-24",name:"server.algolia_app_id",label:e.jsx(s,{message:"Algolia app ID"}),required:!0}),e.jsx(c,{size:"sm",className:"mt-24",name:"server.algolia_secret",label:e.jsx(s,{message:"Algolia app secret"}),required:!0})]})}function R(){const{getValues:r}=l(),{data:t}=I(),i=N(),[m,x]=n.useState("*");return e.jsxs(u,{className:"mb-24",title:e.jsx(s,{message:"Import Records"}),description:e.jsxs(n.Fragment,{children:[e.jsx("p",{children:e.jsx(s,{message:"After changing search method, database records need to be imported into the search index."})}),e.jsx("p",{className:"mt-6",children:e.jsx(s,{message:"Depending on number of records in database, importing could take some time. Don't close this window while it is in progress."})})]}),children:[e.jsxs(D,{size:"sm",selectionMode:"single",label:e.jsx(s,{message:"What to import?"}),selectedValue:m,onSelectionChange:o=>{x(o)},children:[e.jsx(a,{value:"*",children:e.jsx(s,{message:"Everything"})}),t==null?void 0:t.models.map(o=>e.jsx(a,{value:o.model,children:e.jsx(s,{message:o.name})},o.model))]}),e.jsx(M,{size:"sm",variant:"flat",color:"primary",className:"mt-12",disabled:i.isPending,onClick:()=>{i.mutate({model:m,driver:r("server.scout_driver")})},children:e.jsx(s,{message:"Import now"})})]})}export{ge as Component};
