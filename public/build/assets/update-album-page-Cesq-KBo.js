import{z as h,ae as y,q as A,G as v,ag as P,I as F,J as I,aa as C,b as E,j as r,T as l,N as q,at as d,M as N,au as k}from"./main-BEfQELxr.js";import{p as Q,A as S}from"./use-create-album-k8yNEMKL.js";import{g as c}from"./album-link-6XmWl295.js";import{D as U}from"./paginated-resources-CNSIt8ps.js";import{u as B}from"./use-album-permissions-B3fFfLlx.js";import{C as D}from"./crupdate-resource-layout-kU3RGGgA.js";import{u as b}from"./use-required-params-biXhH1lK.js";import{F as L,u as _}from"./file-upload-provider-eR3r-15c.js";import{u as g}from"./useSuspenseQuery-CLDVgKJu.js";import{B as x,a as i}from"./breadcrumb-BEqwPK9x.js";import"./FileUpload-DPKPUe4e.js";import"./Add-Cqjx6ezR.js";import"./DragHandle-nDiL0duR.js";import"./Edit-gh_pXqg9.js";import"./track-form-DaFc8iaY.js";import"./image-selector-D_1V7xO8.js";import"./use-active-upload-nc09ZUBt.js";import"./open-upload-window-B2GQndIr.js";import"./uploaded-file-DYvUNPPs.js";import"./extension-from-filename-O0XMuZye.js";import"./AddAPhoto-CZHH8SXN.js";import"./file-input-config-DrcTpI3-.js";import"./pretty-bytes-bO14ePu9.js";import"./generate-waveform-data-BFwf5N3g.js";import"./form-chip-field-82C9gJw-.js";import"./input-BypPJ39K.js";import"./chip-list-CnaxlPJ9.js";import"./genre-B_3ZyEC1.js";import"./form-normalized-model-chip-field-4XjViKi1.js";import"./use-normalized-models-ChKc2G_X.js";import"./normalized-model-field-AJN-ee7u.js";import"./select-DvPFHFsY.js";import"./combobox-end-adornment-B98K5MYg.js";import"./skeleton-IvCa_cqw.js";import"./formatted-duration-Dqg2KYhd.js";import"./use-current-date-time-Bg8tRM7A.js";import"./use-update-track-form--unhyqKC.js";import"./dialog-footer-DZFPEWVp.js";import"./confirmation-dialog-CYwhNB58.js";import"./music-Bh2SQVZ2.js";import"./use-create-track-form-DVM9TCgc.js";import"./drag-preview-CUlfnP8k.js";import"./use-sortable-CXyvsr-E.js";import"./getScrollParent--OCc5gFh.js";import"./useGlobalListeners-BF1tAQIT.js";import"./date-picker-BHCsGJUh.js";import"./use-date-formatter-BKDPf1lG.js";import"./DateFormatter-Dix9bfnP.js";import"./DateRange-DXC1xWJJ.js";import"./use-base-date-picker-state-C8djIY4i.js";import"./KeyboardArrowRight-BVstfQVU.js";import"./datatable-page-with-header-layout-DgFKm91D.js";import"./dashboard-layout-context-Ors6hOMs.js";import"./use-toggle-dashboard-left-sidebar-BNAUqBUz.js";import"./traditional-D9TTECMQ.js";import"./useEffectEvent-TynbBUG3.js";import"./ChevronRight-BB23vmSu.js";import"./MoreHoriz-B7xw7d55.js";const z=a=>`albums/${a}`;function M(a,e){const{trans:s}=h(),o=y(),{pathname:n}=A();return v({mutationFn:t=>R(e,t),onSuccess:t=>{F(s(I("Album updated"))),C.invalidateQueries({queryKey:U("albums")}),n.includes("admin")?o("/admin/albums"):o(c(t.album))},onError:t=>P(t,a)})}function R(a,e){return E.put(z(a),Q(e)).then(s=>s.data)}function T(a){return r.jsx(L,{children:r.jsx(w,{...a})})}function w({showExternalFields:a=!0,breadcrumbs:e,navbar:s}){const{albumId:o}=b(["albumId"]),t=g(d.albums.get(o,"editAlbumPage")).data.album,{canEdit:f}=B(t),j=!!_(m=>m.activeUploadsCount),u=N({defaultValues:{image:t.image,name:t.name,release_date:t.release_date,artists:t.artists,genres:t.genres,tags:t.tags,description:t.description,spotify_id:t.spotify_id,tracks:t.tracks}}),p=M(u,t.id);return f?r.jsx(D,{form:u,onSubmit:m=>{p.mutate(m)},navbar:s,title:e??r.jsxs(x,{size:"xl",children:[r.jsx(i,{to:"/admin/albums",children:r.jsx(l,{message:"Albums"})}),r.jsx(i,{children:t.name})]}),isLoading:p.isPending||j,disableSaveWhenNotDirty:!0,children:r.jsx(S,{showExternalIdFields:a})}):r.jsx(k,{to:"/",replace:!0})}function Wt(){const{albumId:a}=b(["albumId"]),e=g(d.albums.get(a,"editAlbumPage"));return r.jsx("div",{className:"h-screen",children:r.jsx(T,{showExternalFields:!1,navbar:r.jsx(q,{className:"flex-shrink-0",color:"bg",darkModeColor:"bg"}),breadcrumbs:r.jsxs(x,{size:"xl",children:[r.jsx(i,{to:c(e.data.album),children:e.data.album.name}),r.jsx(i,{children:r.jsx(l,{message:"Edit"})})]})})})}export{Wt as BackstageUpdateAlbumPage,T as Component};
