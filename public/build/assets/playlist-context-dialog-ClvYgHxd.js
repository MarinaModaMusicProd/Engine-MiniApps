import{a as A,at as m,e as P,G as C,H as b,I as c,J as d,aa as h,b as k,j as t,W as y,t as v,T as a,aw as K,q as Q,ae as $,$ as r,r as M,ac as D,aM as G}from"./main-BEfQELxr.js";import{C as R,c as l,d as W,l as H,q as _,u as J,o as p}from"./share-media-button-C9oFSM6L.js";import{A as N,u as V}from"./add-to-queue-menu-button-xRsy1m89.js";import{U as X,u as B}from"./update-playlist-dialog-BF_1fkoi.js";import{P as Y}from"./entitiy-offline-indicator-icon-CUcYL0oT.js";import{P as Z}from"./playable-grid-item-33WysPX-.js";import{P as E}from"./playlist-image-CVgZeVzU.js";import{g as T,P as O}from"./playlist-link-BuIn8fqZ.js";import{C as z}from"./confirmation-dialog-CYwhNB58.js";import{u as ee}from"./use-clipboard-C55rQ_RF.js";import{F as I,a as F}from"./FavoriteBorder-CFF5lN5d.js";function U(e){const{data:s}=A(m.playlists.compactAuthUserPlaylists()),{user:n}=P(),o=s==null?void 0:s.find(i=>i.id===+e);return!!(o&&n&&n.id!==o.owner_id)}function u(e){const{user:s}=P(),n=!!(s!=null&&s.id&&s.id===e.owner_id);return{canEdit:n,canDelete:n,isCreator:n}}function q(e){return C({mutationFn:()=>te(e.id),onSuccess:()=>{c(d("Following :name",{values:{name:e.name}})),h.invalidateQueries({queryKey:m.playlists.invalidateKey})},onError:s=>b(s)})}function te(e){return k.post(`playlists/${e}/follow`).then(s=>s.data)}function L(e){return C({mutationFn:()=>se(e.id),onSuccess:()=>{c(d("Stopped following :name",{values:{name:e.name}})),h.invalidateQueries({queryKey:m.playlists.invalidateKey})},onError:s=>b(s)})}function se(e){return k.post(`playlists/${e}/unfollow`).then(s=>s.data)}function ne({playlist:e,size:s="sm",className:n,buttonType:o="text",radius:i}){const{isCreator:x}=u(e),g=q(e),j=L(e),w=U(e.id),f=g.isPending||j.isPending;return x?null:o==="icon"?w?t.jsx(y,{size:s,radius:i,color:"primary",className:n,disabled:f,onClick:()=>j.mutate(),children:t.jsx(I,{})}):t.jsx(y,{size:s,radius:i,disabled:f,className:n,onClick:()=>g.mutate(),children:t.jsx(F,{})}):w?t.jsx(v,{size:s,variant:"outline",radius:i||"rounded-full",startIcon:t.jsx(I,{className:"text-primary"}),disabled:f,className:n,onClick:()=>j.mutate(),children:t.jsx(a,{message:"Following"})}):t.jsx(v,{size:s,variant:"outline",radius:i||"rounded-full",startIcon:t.jsx(F,{}),disabled:f,className:n,onClick:()=>g.mutate(),children:t.jsx(a,{message:"Follow"})})}function ve({playlist:e,layout:s}){return t.jsx(Z,{layout:s,image:t.jsx(E,{playlist:e}),title:t.jsx(O,{playlist:e}),subtitle:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(Y,{playlistId:e.id}),t.jsx(S,{playlist:e})]}),link:T(e),likeButton:t.jsx(ne,{buttonType:"icon",size:"md",playlist:e}),model:e,contextDialog:t.jsx(ae,{playlist:e})})}function S({playlist:e}){const s=e.editors[0];return s?t.jsx(a,{message:"By :name",values:{name:t.jsx(K,{user:s})}}):null}function oe(e){const{pathname:s}=Q(),n=$(),{getRedirectUri:o}=P();return C({mutationFn:()=>ie(e),onSuccess:()=>{c(d("Playlist deleted")),h.invalidateQueries({queryKey:m.playlists.invalidateKey}),s.startsWith(`/playlist/${e}`)&&n(o())},onError:i=>b(i)})}function ie(e){return k.delete(`playlists/${e}`).then(s=>s.data)}function ae({playlist:e}){const{close:s}=r(),[,n]=ee(T(e,{absolute:!0})),{canEdit:o}=u(e),i=M.useCallback(()=>fe(e),[e]);return t.jsxs(R,{image:t.jsx(E,{playlist:e}),title:t.jsx(O,{playlist:e}),description:t.jsx(S,{playlist:e}),loadTracks:i,children:[t.jsx(N,{item:e,loadTracks:i}),t.jsx(ue,{playlist:e}),t.jsx(ce,{playlist:e}),t.jsx(le,{playlist:e}),t.jsx(re,{playlist:e}),t.jsx(l,{onClick:()=>{n(),s(),c(d("Copied link to clipboard"))},children:t.jsx(a,{message:"Copy playlist link"})}),e.public&&t.jsx(W,{item:e}),o&&t.jsx(l,{onClick:()=>{s(),D(X,{playlist:e})},children:t.jsx(a,{message:"Edit"})}),t.jsx(de,{playlist:e})]})}function le({playlist:e}){const s=U(e.id),{close:n}=r(),o=q(e),i=L(e),{isCreator:x}=u(e);return x?null:t.jsx(M.Fragment,{children:s?t.jsx(l,{onClick:()=>{n(),i.mutate()},children:t.jsx(a,{message:"Unfollow"})}):t.jsx(l,{onClick:()=>{n(),o.mutate()},children:t.jsx(a,{message:"Follow"})})})}function re({playlist:e}){const{close:s}=r(),n=V(),o=J(i=>i.offlinedPlaylistIds.has(e.id));return n?t.jsx(l,{enableWhileOffline:!0,onClick:async()=>{s(),o?p().deleteOfflinedMediaItem(e):p().offlineMediaItem(e)},children:o?t.jsx(a,{message:"Remove from this device"}):t.jsx(a,{message:"Make available offline"})}):null}function ue({playlist:e}){const{close:s}=r(),n=B({playlistId:e.id}),{isCreator:o}=u(e);if(!o)return null;const i=()=>{s(),n.mutate({public:!e.public})};return t.jsx(l,{disabled:n.isPending,onClick:()=>i(),children:e.public?t.jsx(a,{message:"Make private"}):t.jsx(a,{message:"Make public"})})}function ce({playlist:e}){const{close:s}=r(),n=B({playlistId:e.id}),{isCreator:o}=u(e);if(!o)return null;const i=()=>{s(),n.mutate({collaborative:!e.collaborative})};return t.jsx(l,{disabled:n.isPending,startIcon:e.collaborative?t.jsx(G,{}):void 0,onClick:()=>i(),children:t.jsx(a,{message:"Collaborative"})})}function de({playlist:e}){const{close:s}=r(),n=oe(e.id),{canDelete:o}=u(e);return o?t.jsx(l,{disabled:n.isPending,onClick:()=>{s(),D(z,{isDanger:!0,title:t.jsx(a,{message:"Delete playlist"}),body:t.jsx(a,{message:"Are you sure you want to delete this playlist?"}),confirm:t.jsx(a,{message:"Delete"}),onConfirm:()=>{n.mutate()}})},children:t.jsx(a,{message:"Delete"})}):null}async function fe(e){const s=await H(_(e));return s.length||c(d("This playlist has no tracks yet.")),s}export{ne as F,ae as P,S as a,ve as b,u};
