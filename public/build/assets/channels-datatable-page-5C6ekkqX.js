import{j as e,T as t,v as c,W as v,u as T,a8 as I,a9 as P,z as A,G as d,H as p,aa as u,Y as g,I as x,J as h,b as j,r as y,S as H,ab as N,D as k,t as f,a4 as M,ac as E,ad as L,a5 as F,Q as q,$ as b}from"./main-BEfQELxr.js";import{E as z}from"./Edit-gh_pXqg9.js";import{H as B}from"./Home-B0aHzR5D.js";import{F as Q}from"./formatted-date-B-08Y9yP.js";import{C as $}from"./channels-docs-link-Cbcmckbq.js";import{u as W,a as _,G as K,D as G,b as R,c as U}from"./use-datatable-query-DPUO64j4.js";import{D as J}from"./data-table-add-item-button-BdngBic4.js";import{a as V,D as Y,b as O,c as X}from"./datatable-page-with-header-layout-DgFKm91D.js";import{T as Z}from"./table-Bdp6S_DF.js";import{C as D}from"./confirmation-dialog-CYwhNB58.js";import{p as ee}from"./playlist-WVznIqu7.js";import"./use-date-formatter-BKDPf1lG.js";import"./DateFormatter-Dix9bfnP.js";import"./admin-config-BaCrw7Kt.js";import"./Album-CXNrxcWI.js";import"./Comment-TqhRbk6J.js";import"./FileUpload-DPKPUe4e.js";import"./Mic-cPqrQSx8.js";import"./PlaylistPlay-jDnYmdDX.js";import"./QueueMusic-C8vaKlwp.js";import"./Sell-DvbBmLb2.js";import"./settings-links-BagG4yO6.js";import"./external-link-CT1zJoZ3.js";import"./FilterAlt-Cy68O-Jt.js";import"./form-normalized-model-chip-field-4XjViKi1.js";import"./use-normalized-models-ChKc2G_X.js";import"./form-chip-field-82C9gJw-.js";import"./input-BypPJ39K.js";import"./chip-list-CnaxlPJ9.js";import"./accordion-CpkAY-cS.js";import"./checkbox-C191zCCH.js";import"./CheckBoxOutlineBlank-B_WkUAPG.js";import"./ArrowRightAlt-CIybcFtZ.js";import"./DateRange-DXC1xWJJ.js";import"./use-base-date-picker-state-C8djIY4i.js";import"./KeyboardArrowRight-BVstfQVU.js";import"./use-date-range-picker-state-CLLDtAYm.js";import"./list-C_muhLNE.js";import"./switch-kVp777pB.js";import"./dialog-footer-DZFPEWVp.js";import"./is-tablet-media-query-BWKVDwFI.js";import"./use-current-date-time-Bg8tRM7A.js";import"./select-DvPFHFsY.js";import"./combobox-end-adornment-B98K5MYg.js";import"./normalized-model-field-AJN-ee7u.js";import"./skeleton-IvCa_cqw.js";import"./Add-Cqjx6ezR.js";import"./dashboard-layout-context-Ors6hOMs.js";import"./use-toggle-dashboard-left-sidebar-BNAUqBUz.js";import"./ArrowDownward-i0hV0JR6.js";import"./useInteractOutside-Iqh6soAi.js";import"./useEffectEvent-TynbBUG3.js";import"./is-ctrl-or-shift-pressed-CMgU9cG9.js";import"./use-pointer-events-CdAPueCj.js";import"./useGlobalListeners-BF1tAQIT.js";const ae=[{key:"name",allowsSorting:!0,width:"flex-3",visibleInMode:"all",header:()=>e.jsx(t,{message:"Name"}),body:a=>e.jsxs("div",{children:[e.jsx("div",{className:"overflow-hidden overflow-ellipsis whitespace-nowrap font-medium",children:e.jsx(se,{channel:a})}),a.config.adminDescription&&e.jsx("p",{className:"max-w-680 whitespace-normal text-xs text-muted",children:a.config.adminDescription})]})},{key:"content",allowsSorting:!1,header:()=>e.jsx(t,{message:"Content"}),body:a=>e.jsx(te,{channel:a})},{key:"content_type",allowsSorting:!1,header:()=>e.jsx(t,{message:"Content type"}),body:a=>e.jsx("span",{className:"capitalize",children:a.config.contentModel?e.jsx(t,{message:a.config.contentModel}):void 0})},{key:"internal",allowsSorting:!0,maxWidth:"max-w-100",hideHeader:!0,header:()=>e.jsx(t,{message:"Internal"}),body:a=>e.jsx(ne,{channel:a})},{key:"updated_at",allowsSorting:!0,maxWidth:"max-w-100",header:()=>e.jsx(t,{message:"Last updated"}),body:a=>a.updated_at?e.jsx(Q,{date:a.updated_at}):""},{key:"actions",header:()=>e.jsx(t,{message:"Actions"}),hideHeader:!0,visibleInMode:"all",align:"end",width:"w-42 flex-shrink-0",body:a=>e.jsx(c,{to:`${a.id}/edit`,className:"text-muted",children:e.jsx(v,{size:"md",children:e.jsx(z,{})})})}];function te({channel:a}){switch(a.config.contentType){case"listAll":return e.jsx(t,{message:"List all"});case"manual":return e.jsx(t,{message:"Managed manually"});case"autoUpdate":return e.jsx(t,{message:"Updated automatically"})}}function se({channel:a}){return a.config.restriction&&a.config.restrictionModelId==="urlParam"?a.name:e.jsx("a",{className:"outline-none hover:underline focus-visible:underline",href:`channel/${a.slug}`,target:"_blank",rel:"noreferrer",children:a.name})}function ne({channel:a}){const{homepage:s}=T(),n=a.internal?e.jsx(I,{label:e.jsx(t,{message:"This channel is required for some site functionality to work properly and can't be deleted."}),children:e.jsx("div",{children:e.jsx(P,{className:"w-max",size:"xs",radius:"rounded-panel",children:e.jsx(t,{message:"Internal"})})})}):"",r=(s==null?void 0:s.type)==="channels"&&`${s.value}`==`${a.id}`;return e.jsxs("div",{className:"flex items-center gap-6",children:[n,r?e.jsx(B,{className:"text-muted",size:"sm"}):null]})}function re(){const{trans:a}=A();return d({mutationFn:s=>oe(s),onSuccess:async()=>{await u.invalidateQueries({queryKey:g.invalidateKey}),x(a(h("Channel preset applied")))},onError:s=>p(s)})}function oe(a){return j.post("channel/apply-preset",a).then(s=>s.data)}function da(){var m;const[a,s]=y.useState([]),{searchParams:n,sortDescriptor:r,mergeIntoSearchParams:o,setSearchQuery:C,isFiltering:w}=W(N),i=_(g.index(n)),S=e.jsxs(k,{type:"modal",children:[e.jsx(f,{variant:"flat",color:"danger",children:e.jsx(t,{message:"Delete"})}),e.jsx(me,{selectedIds:a,onDelete:()=>s([])})]});return e.jsxs(V,{children:[e.jsx(K,{query:i}),e.jsx(H,{children:e.jsx(t,{message:"Channels"})}),e.jsx(Y,{title:e.jsx(t,{message:"Channels"}),rightContent:e.jsx($,{variant:"button"}),showSidebarToggleButton:!0}),e.jsxs(O,{children:[e.jsx(G,{searchValue:n.query,onSearchChange:C,actions:e.jsx(ie,{presets:(m=i.data)==null?void 0:m.presets}),selectedItems:a,selectedActions:S}),e.jsxs(X,{children:[e.jsx(Z,{cellHeight:"h-52",columns:ae,data:i.items,sortDescriptor:r,onSortChange:o,enableSelection:!0,selectedRows:a,onSelectionChange:s}),i.isEmpty&&e.jsx(R,{isFiltering:w,image:ee,title:e.jsx(t,{message:"No channels have been created yet"}),filteringTitle:e.jsx(t,{message:"No matching channels"})}),e.jsx(U,{query:i,onPageChange:l=>o({page:l}),onPerPageChange:l=>o({perPage:l})})]})]})]})}function ie({presets:a}){return e.jsxs(y.Fragment,{children:[e.jsxs(M,{onItemSelected:s=>E(le,{preset:s}),children:[e.jsx(f,{variant:"outline",color:"primary",size:"sm",endIcon:e.jsx(L,{}),disabled:!(a!=null&&a.length),children:e.jsx(t,{message:"Apply preset"})}),e.jsx(F,{children:a==null?void 0:a.map(s=>e.jsx(q,{value:s.preset,description:e.jsx(t,{message:s.description}),children:e.jsx(t,{message:s.name})},s.preset))})]}),e.jsx(J,{elementType:c,to:"new",children:e.jsx(t,{message:"Add new channel"})})]})}function le({preset:a}){const{close:s}=b(),n=re();return e.jsx(D,{isLoading:n.isPending,onConfirm:()=>{n.mutate({preset:a},{onSuccess:()=>s()})},isDanger:!0,title:e.jsx(t,{message:"Apply preset"}),body:e.jsx(t,{message:"Are you sure you want to apply this channel preset? This will delete all current channels and leave only channels from the selected preset."}),confirm:e.jsx(t,{message:"Apply"})})}function me({selectedIds:a,onDelete:s}){const{close:n}=b(),r=d({mutationFn:()=>j.delete(`channels/${a.join(",")}`),onSuccess:async()=>{await u.invalidateQueries({queryKey:["channels"]}),x(h("Channels deleted")),s(),n()},onError:o=>p(o)});return e.jsx(D,{isDanger:!0,isLoading:r.isPending,title:e.jsx(t,{message:"Delete channels"}),body:e.jsx(t,{message:"Are you sure you want to delete selected channels?",values:{count:a.length}}),confirm:e.jsx(t,{message:"Delete"}),onConfirm:()=>r.mutate()})}export{da as Component};
