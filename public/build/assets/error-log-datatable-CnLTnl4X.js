import{j as e,T as i,co as c,d,E as p,z as g,G as u,H as x,aa as f,I as h,J as j,b as D,bx as y,cV as b,r as m,t as S,ac as v,Q as F,cW as w}from"./main-BEfQELxr.js";import{I as C}from"./Info-ZOh_50La.js";import{D as T}from"./paginated-resources-CNSIt8ps.js";import{u as E,a as I,G as L,D as P,b as Q,c as z}from"./use-datatable-query-DPUO64j4.js";import{D as M}from"./data-table-add-item-button-BdngBic4.js";import{a as k,b as B,c as H}from"./datatable-page-with-header-layout-DgFKm91D.js";import{T as q}from"./table-Bdp6S_DF.js";import{S as A}from"./select-DvPFHFsY.js";import{F as N}from"./formatted-bytes-rr-Dirta.js";import{D as R}from"./Download-Dfp9nObW.js";import{C as W}from"./confirmation-dialog-CYwhNB58.js";import{S as G}from"./skeleton-IvCa_cqw.js";import"./FilterAlt-Cy68O-Jt.js";import"./form-normalized-model-chip-field-4XjViKi1.js";import"./use-normalized-models-ChKc2G_X.js";import"./form-chip-field-82C9gJw-.js";import"./input-BypPJ39K.js";import"./chip-list-CnaxlPJ9.js";import"./accordion-CpkAY-cS.js";import"./checkbox-C191zCCH.js";import"./CheckBoxOutlineBlank-B_WkUAPG.js";import"./ArrowRightAlt-CIybcFtZ.js";import"./DateRange-DXC1xWJJ.js";import"./use-base-date-picker-state-C8djIY4i.js";import"./use-date-formatter-BKDPf1lG.js";import"./DateFormatter-Dix9bfnP.js";import"./KeyboardArrowRight-BVstfQVU.js";import"./use-date-range-picker-state-CLLDtAYm.js";import"./list-C_muhLNE.js";import"./switch-kVp777pB.js";import"./formatted-date-B-08Y9yP.js";import"./dialog-footer-DZFPEWVp.js";import"./is-tablet-media-query-BWKVDwFI.js";import"./use-current-date-time-Bg8tRM7A.js";import"./normalized-model-field-AJN-ee7u.js";import"./Edit-gh_pXqg9.js";import"./Add-Cqjx6ezR.js";import"./dashboard-layout-context-Ors6hOMs.js";import"./use-toggle-dashboard-left-sidebar-BNAUqBUz.js";import"./ArrowDownward-i0hV0JR6.js";import"./useInteractOutside-Iqh6soAi.js";import"./useEffectEvent-TynbBUG3.js";import"./is-ctrl-or-shift-pressed-CMgU9cG9.js";import"./use-pointer-events-CdAPueCj.js";import"./useGlobalListeners-BF1tAQIT.js";import"./combobox-end-adornment-B98K5MYg.js";import"./pretty-bytes-bO14ePu9.js";const V=""+new URL("bug-fixing-BghMoLQY.svg",import.meta.url).href,K=[{key:"message",visibleInMode:"all",width:"flex-3 min-w-200",header:()=>e.jsx(i,{message:"Message"}),body:t=>t.message},{key:"datetime",header:()=>e.jsx(i,{message:"Date"}),body:t=>e.jsx(c,{date:t.datetime})},{key:"severity",header:()=>e.jsx(i,{message:"Severity"}),body:t=>e.jsxs("span",{className:d("flex items-center gap-6 text-xs capitalize",t.level==="error"?"text-danger":"text-primary"),children:[t.level==="error"?e.jsx(p,{size:"sm"}):e.jsx(C,{size:"sm"}),t.level]})}];function $(){const{trans:t}=g();return u({mutationFn:r=>J(r),onSuccess:async()=>{await f.invalidateQueries({queryKey:T("logs/error")}),h(t(j("Log file deleted")))},onError:r=>x(r)})}function J({identifier:t}){return D.delete(`logs/error/${t}`).then(r=>r.data)}function Ve(){const{searchParams:t,sortDescriptor:r,mergeIntoSearchParams:o,setSearchQuery:a,isFiltering:l}=E(b),n=I({...y.logs.error(t)});return e.jsxs(k,{children:[e.jsx(L,{query:n}),e.jsxs(B,{children:[e.jsx(P,{searchValue:t.query,onSearchChange:a,actions:e.jsx(O,{data:n.data,onParamsChange:o})}),e.jsxs(H,{children:[e.jsx(q,{columns:K,data:n.items,sortDescriptor:r,onSortChange:o,enableSelection:!1}),n.isEmpty&&e.jsx(Q,{isFiltering:l,image:V,title:e.jsx(i,{message:"No errors have been logged yet"}),filteringTitle:e.jsx(i,{message:"No matching error log entries"})}),e.jsx(z,{query:n,onPageChange:s=>o({page:s}),onPerPageChange:s=>o({perPage:s})})]})]})]})}function O({data:t,onParamsChange:r}){var n;const o=m.useRef(!1),[a,l]=m.useState(null);return m.useEffect(()=>{if(t.files.length&&!o.current){o.current=!0;const s=t.files[0].identifier;l(s),s!==t.selectedFile&&r({file:s})}},[t,r,o]),e.jsxs(m.Fragment,{children:[e.jsx(U,{files:t.files??null,selectedFile:a,onSelected:s=>{l(s.identifier),r({file:s.identifier})}}),e.jsx(S,{variant:"outline",color:"danger",disabled:!a,onClick:()=>v(Y,{identifier:a}),children:e.jsx(i,{message:"Delete"})}),a&&e.jsx(M,{elementType:"a",download:(n=t.files.find(s=>s.identifier===a))==null?void 0:n.name,href:`api/v1/logs/error/${a}/download`,icon:e.jsx(R,{}),children:e.jsx(i,{message:"Download log"})})]})}function U({files:t,selectedFile:r,onSelected:o}){return t?t.length?e.jsx(A,{appearance:"dropdown",selectionMode:"single",selectedValue:r,size:"sm",minWidth:"min-w-[210px]",children:t==null?void 0:t.map(a=>e.jsxs(F,{value:a.identifier,onSelected:()=>o(a),children:[a.name," (",e.jsx(N,{bytes:a.size}),")"]},a.identifier))}):null:e.jsx(G,{variant:"rect",className:"max-w-[210px]"})}function Y({identifier:t}){const r=$();return e.jsx(W,{title:e.jsx(i,{message:"Delete log file"}),body:e.jsx(i,{message:"Are you sure you want to delete this log file?"}),confirm:e.jsx(i,{message:"Delete"}),onConfirm:()=>r.mutate({identifier:t},{onSuccess:()=>w()}),isLoading:r.isPending,isDanger:!0})}export{Ve as Component};
